(function(){$(function(){Vue.component("vue-groups-container",{props:["groups","currentgroup"],template:"#groupsContainerTemplate",methods:{changeGroup:function(n,t){n!==t&&(n&&(n.isCurrent=!1),t.isCurrent=!0,currentgroup=t,console.log("changeGroup todo",currentgroup))}}});Vue.component("vue-friends-container",{props:["friends"],template:"#friendsContainerTemplate",methods:{goChat:function(){console.log("goChat todo")}}});Vue.component("vue-messages-container",{props:["currentgroup","readystate","messages"],template:"#messagesContainerTemplate",methods:{sendMessage:function(){var n=$("#message").val(),t,i;n.trim()!==""&&(t={gid:1,uid:1,msg:n},i=serializeMsgPack(t),chat.sendCommand(chat.commandType.SendMessage,chat.dataType.MessagePack,i),$("#message").val(""))}}});var n=new Vue({el:"#chatApp",data:{currentgroup:{gname:"",gid:""},readystate:3,friends:[{uid:1,uname:"张一疯",ico:"/images/user.png"},{uid:2,uname:"张二疯",ico:"/images/user.png"},{uid:3,uname:"张三疯",ico:"/images/user.png"}],messages:[],groups:[{gid:1,gname:"学前班1班",ico:"/images/user.png",lstmsg:"hello,nice to meet you.",lsttime:"2019-02-14 14:23",unread:99,isCurrent:!0},{gid:2,gname:"学前班2班",ico:"/images/user.png",lstmsg:"hello,nice to meet you.",lsttime:"2019-02-14 14:23",unread:99,isCurrent:!1}]},methods:{}});abp.event.on("websocket.onopen",function(){n.readystate=1});abp.event.on("websocket.onclose",function(){n.readystate=3});abp.event.on("websocket.onerror",function(){console.log("onerror",event)});abp.event.on("websocket.onreceivebinary",function(t){var i=chat.receiveCommand(t),r;i.dataType===chat.dataType.MessagePack&&(r=deserializeMsgPack(i.data),i.commandType===chat.commandType.GetMessage&&(n.messages=n.messages.concat(r)))});abp.event.on("websocket.onreceiveblob",function(){});abp.event.on("websocket.onreceivetext",function(n){var t,i;console.log(n);t=JSON.parse(n);switch(t.CommandType){case chat.commandType.Connected:i=JSON.parse(t.Data);abp.utils.setCookieValue("chatConnectionId",i.ConnectionId)}});chat.init();$("#message").focus()})})();